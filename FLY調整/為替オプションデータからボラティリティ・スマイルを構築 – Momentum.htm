<!DOCTYPE html>
<!-- saved from url=(0223)http://nekopuni.holy.jp/2014/11/r%E7%82%BA%E6%9B%BF%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8B%E3%82%89%E3%83%9C%E3%83%A9%E3%83%86%E3%82%A3%E3%83%AA%E3%83%86%E3%82%A3%E3%83%BB%E3%82%B9/ -->
<html lang="en-GB" class=""><!--<![endif]--><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="http://nekopuni.holy.jp/xmlrpc.php">
<!--[if lt IE 9]>
<script src="http://nekopuni.holy.jp/wp-content/themes/first/js/html5shiv.js"></script>
<![endif]-->
<title>為替オプションデータからボラティリティ・スマイルを構築 – Momentum</title>
<link rel="dns-prefetch" href="http://fonts.googleapis.com/">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="Momentum » Feed" href="http://nekopuni.holy.jp/feed/">
<link rel="alternate" type="application/rss+xml" title="Momentum » Comments Feed" href="http://nekopuni.holy.jp/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="Momentum » 為替オプションデータからボラティリティ・スマイルを構築 Comments Feed" href="http://nekopuni.holy.jp/2014/11/r%e7%82%ba%e6%9b%bf%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8b%e3%82%89%e3%83%9c%e3%83%a9%e3%83%86%e3%82%a3%e3%83%aa%e3%83%86%e3%82%a3%e3%83%bb%e3%82%b9/feed/">
		<script id="twitter-wjs" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/widgets.js"></script><script async="" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/analytics.js"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/nekopuni.holy.jp\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.9"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel="stylesheet" id="crayon-css" href="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/crayon.min.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-theme-familiar-css" href="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/familiar.css" type="text/css" media="all">
<link rel="stylesheet" id="crayon-font-monaco-css" href="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/monaco.css" type="text/css" media="all">
<link rel="stylesheet" id="first-font-css" href="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/css" type="text/css" media="all">
<link rel="stylesheet" id="first-genericons-css" href="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/genericons.css" type="text/css" media="all">
<link rel="stylesheet" id="first-normalize-css" href="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/normalize.css" type="text/css" media="all">
<link rel="stylesheet" id="first-style-css" href="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/style.css" type="text/css" media="all">
<!--[if IE 8]>
<link rel='stylesheet' id='first-non-responsive-css'  href='http://nekopuni.holy.jp/wp-content/themes/first/css/non-responsive.css' type='text/css' media='all' />
<![endif]-->
<link rel="stylesheet" id="really_simple_share_style-css" href="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/style(1).css" type="text/css" media="all">
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/jquery.js"></script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/jquery-migrate.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var quicktagsL10n = {"closeAllOpenTags":"Close all open tags","closeTags":"close tags","enterURL":"Enter the URL","enterImageURL":"Enter the URL of the image","enterImageDescription":"Enter a description of the image","textdirection":"text direction","toggleTextdirection":"Toggle Editor Text Direction","dfw":"Distraction-free writing mode","strong":"Bold","strongClose":"Close bold tag","em":"Italic","emClose":"Close italic tag","link":"Insert link","blockquote":"Blockquote","blockquoteClose":"Close blockquote tag","del":"Deleted text (strikethrough)","delClose":"Close deleted text tag","ins":"Inserted text","insClose":"Close inserted text tag","image":"Insert image","ul":"Bulleted list","ulClose":"Close bulleted list tag","ol":"Numbered list","olClose":"Close numbered list tag","li":"List item","liClose":"Close list item tag","code":"Code","codeClose":"Close code tag","more":"Insert Read More tag"};
/* ]]> */
</script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/quicktags.min.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/nekopuni.holy.jp\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
var CrayonTagEditorSettings = {"home_url":"http:\/\/nekopuni.holy.jp","css":"crayon-te","css_selected":"crayon-selected","code_css":"#crayon-code","url_css":"#crayon-url","url_info_css":"#crayon-te-url-info","lang_css":"#crayon-lang","title_css":"#crayon-title","mark_css":"#crayon-mark","range_css":"#crayon-range","inline_css":"crayon-inline","inline_hide_css":"crayon-hide-inline","inline_hide_only_css":"crayon-hide-inline-only","hl_css":"#crayon-highlight","switch_html":"#content-html","switch_tmce":"#content-tmce","tinymce_button_generic":".mce-btn","tinymce_button":"a.mce_crayon_tinymce,.mce-i-crayon_tinymce","tinymce_button_unique":"mce_crayon_tinymce","tinymce_highlight":"mce-active","submit_css":"#crayon-te-ok","cancel_css":"#crayon-te-cancel","content_css":"#crayon-te-content","dialog_title_css":"#crayon-te-title","submit_wrapper_css":"#crayon-te-submit-wrapper","data_value":"data-value","attr_sep":":","css_sep":"_","fallback_lang":"default","add_text":"Add Code","edit_text":"Edit Code","quicktag_text":"crayon","submit_add":"Add","submit_edit":"Save","bar":"#crayon-te-bar","bar_content":"#crayon-te-bar-content","extensions":{"scpt":"applescript","applescript":"applescript","swf":"as","fla":"as","cs":"c#","h":"c++","hh":"c++","hpp":"c++","hxx":"c++","h++":"c++","cc":"c++","cpp":"c++","cxx":"c++","c++":"c++","pas":"delphi","java":"java","class":"java","jar":"java","mel":"mel","ma":"mel","mv":"miva","mvc":"miva","mvt":"miva","m":"objc","mm":"objc","psc":"papyrus","pl":"perl","py":"python","pyw":"python","pyc":"python","pyo":"python","pyd":"python","rb":"ruby","rbx":"ruby","rhtml":"ruby","vbs":"vb"}};
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"http:\/\/nekopuni.holy.jp\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/crayon.te.min.js"></script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/ai.js"></script>
<link rel="https://api.w.org/" href="http://nekopuni.holy.jp/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://nekopuni.holy.jp/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://nekopuni.holy.jp/wp-includes/wlwmanifest.xml"> 
<link rel="prev" title="為替秒足データへのOne pass algorithmの適用" href="http://nekopuni.holy.jp/2014/10/rpython%e7%82%ba%e6%9b%bf%e7%a7%92%e8%b6%b3%e3%83%87%e3%83%bc%e3%82%bf%e3%81%b8%e3%81%aeone-pass-algorithm%e3%81%ae%e9%81%a9%e7%94%a8/">
<link rel="next" title="csv読み込み備忘録" href="http://nekopuni.holy.jp/2014/11/pythoncsv%e8%aa%ad%e3%81%bf%e8%be%bc%e3%81%bf%e5%82%99%e5%bf%98%e9%8c%b2/">
<meta name="generator" content="WordPress 4.9.9">
<link rel="canonical" href="http://nekopuni.holy.jp/2014/11/r%e7%82%ba%e6%9b%bf%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8b%e3%82%89%e3%83%9c%e3%83%a9%e3%83%86%e3%82%a3%e3%83%aa%e3%83%86%e3%82%a3%e3%83%bb%e3%82%b9/">
<link rel="shortlink" href="http://nekopuni.holy.jp/?p=1327">
<link rel="alternate" type="application/json+oembed" href="http://nekopuni.holy.jp/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fnekopuni.holy.jp%2F2014%2F11%2Fr%25e7%2582%25ba%25e6%259b%25bf%25e3%2582%25aa%25e3%2583%2597%25e3%2582%25b7%25e3%2583%25a7%25e3%2583%25b3%25e3%2583%2587%25e3%2583%25bc%25e3%2582%25bf%25e3%2581%258b%25e3%2582%2589%25e3%2583%259c%25e3%2583%25a9%25e3%2583%2586%25e3%2582%25a3%25e3%2583%25aa%25e3%2583%2586%25e3%2582%25a3%25e3%2583%25bb%25e3%2582%25b9%2F">
<link rel="alternate" type="text/xml+oembed" href="http://nekopuni.holy.jp/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fnekopuni.holy.jp%2F2014%2F11%2Fr%25e7%2582%25ba%25e6%259b%25bf%25e3%2582%25aa%25e3%2583%2597%25e3%2582%25b7%25e3%2583%25a7%25e3%2583%25b3%25e3%2583%2587%25e3%2583%25bc%25e3%2582%25bf%25e3%2581%258b%25e3%2582%2589%25e3%2583%259c%25e3%2583%25a9%25e3%2583%2586%25e3%2582%25a3%25e3%2583%25aa%25e3%2583%2586%25e3%2582%25a3%25e3%2583%25bb%25e3%2582%25b9%2F&amp;format=xml">
	<style type="text/css">
		/* Fonts */
				html {
			font-size: 80%;
		}
				body {
									font-size: 14px;
					}
				@media screen and (max-width: 782px) {
						html {
				font-size: 72%;
			}
									body {
				font-size: 13.2px;
			}
					}
				
		/* Colors */
					.site-bar, .main-navigation ul ul {
				background-color: #803e3e;
			}
			.footer-area {
				background-color: #3a3232;
			}
			.entry-content a, .entry-summary a, .page-content a, .comment-content a, .post-navigation a {
				color: #914b4b;
			}
			a:hover {
				color: #c66767;
			}
		
				/* Title */
			.site-title {
								font-family: 'Lato', sans-serif;
												font-weight: 400;
																											}
								
			</style>
		<style type="text/css" id="first-custom-css">
			</style>
			<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-18453953-3', 'auto');
  ga('send', 'pageview');

</script>

<!-- fancybox -->
<link rel="stylesheet" href="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/jquery.fancybox.css" type="text/css" media="screen">
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
    jQuery(document).ready(function($){
        $(".fancybox").fancybox();
    });
</script>

<script src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/MathJax.js" id="">
</script>
<script async="" type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/count.js"></script><script type="text/javascript" async="" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/embed.js"></script><style type="text/css">.fancybox-margin{margin-right:0px;}</style><script charset="utf-8" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/button.e96bb6acc0f8bda511c0c46a84ee18e4.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript">function a() {	 document.addEventListener('keydown', function(e){		/*console.log('keydown');*/		var keys = [];		if(e.ctrlKey || e.shiftKey || e.altKey || e.metaKey) {			if(e.metaKey) {				keys.push('Cmd');			}			if(e.shiftKey) {				keys.push('Shift');			}			if(e.ctrlKey)			{				keys.push('Ctrl');			}			if(e.altKey) {				keys.push('Alt');			}		}		if(e.which)		{			/*console.log(e.which);*/			keys.push(String.fromCharCode(e.which));		}		/*console.log(keys.join('+'));*/		if(keys.length >= 2 && keys[keys.length-1] != '') {			window.postMessage({type: 'dolphin_shortcuts', keys:keys}, '*');		}	 });}a();</script><script type="text/javascript"> window.oncontextmenu = function(event) {    var target = event.target.getAttribute('obj_url');	 window.postMessage({type: 'dolphin_clickTarget', target:target}, '*'); };</script><script src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/count-data.js"></script><link rel="preload" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.d49f53e192b9080ef8880a7c9b24f1c3.css"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.9fa8958b421fb4fe8932a2bbb1e656d5.js"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.0687f63ad0515694420458c2bd48d53b.js"><link rel="preload" as="script" href="https://disqus.com/next/config.js"><style type="text/css">.mjx-chtml {display: inline-block; line-height: 0; text-indent: 0; text-align: left; text-transform: none; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; letter-spacing: normal; word-wrap: normal; word-spacing: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; margin: 0; padding: 1px 0}
.MJXc-display {display: block; text-align: center; margin: 1em 0; padding: 0}
.mjx-chtml[tabindex]:focus, body :focus .mjx-chtml[tabindex] {display: inline-table}
.mjx-full-width {text-align: center; display: table-cell!important; width: 10000em}
.mjx-math {display: inline-block; border-collapse: separate; border-spacing: 0}
.mjx-math * {display: inline-block; -webkit-box-sizing: content-box!important; -moz-box-sizing: content-box!important; box-sizing: content-box!important; text-align: left}
.mjx-numerator {display: block; text-align: center}
.mjx-denominator {display: block; text-align: center}
.MJXc-stacked {height: 0; position: relative}
.MJXc-stacked > * {position: absolute}
.MJXc-bevelled > * {display: inline-block}
.mjx-stack {display: inline-block}
.mjx-op {display: block}
.mjx-under {display: table-cell}
.mjx-over {display: block}
.mjx-over > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-under > * {padding-left: 0px!important; padding-right: 0px!important}
.mjx-stack > .mjx-sup {display: block}
.mjx-stack > .mjx-sub {display: block}
.mjx-prestack > .mjx-presup {display: block}
.mjx-prestack > .mjx-presub {display: block}
.mjx-delim-h > .mjx-char {display: inline-block}
.mjx-surd {vertical-align: top}
.mjx-mphantom * {visibility: hidden}
.mjx-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 2px 3px; font-style: normal; font-size: 90%}
.mjx-annotation-xml {line-height: normal}
.mjx-menclose > svg {fill: none; stroke: currentColor}
.mjx-mtr {display: table-row}
.mjx-mlabeledtr {display: table-row}
.mjx-mtd {display: table-cell; text-align: center}
.mjx-label {display: table-row}
.mjx-box {display: inline-block}
.mjx-block {display: block}
.mjx-span {display: inline}
.mjx-char {display: block; white-space: pre}
.mjx-itable {display: inline-table; width: auto}
.mjx-row {display: table-row}
.mjx-cell {display: table-cell}
.mjx-table {display: table; width: 100%}
.mjx-line {display: block; height: 0}
.mjx-strut {width: 0; padding-top: 1em}
.mjx-vsize {width: 0}
.MJXc-space1 {margin-left: .167em}
.MJXc-space2 {margin-left: .222em}
.MJXc-space3 {margin-left: .278em}
.mjx-chartest {display: block; visibility: hidden; position: absolute; top: 0; line-height: normal; font-size: 500%}
.mjx-chartest .mjx-char {display: inline}
.mjx-chartest .mjx-box {padding-top: 1000px}
.MJXc-processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MJXc-processed {display: none}
.mjx-test {display: block; font-style: normal; font-weight: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-transform: none; letter-spacing: normal; word-spacing: normal; overflow: hidden; height: 1px}
.mjx-ex-box-test {position: absolute; width: 1px; height: 60ex}
.mjx-line-box-test {display: table!important}
.mjx-line-box-test span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
#MathJax_CHTML_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.mjx-chtml .mjx-noError {line-height: 1.2; vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
.MJXc-TeX-unknown-R {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: normal}
.MJXc-TeX-unknown-I {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: normal}
.MJXc-TeX-unknown-B {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: normal; font-weight: bold}
.MJXc-TeX-unknown-BI {font-family: STIXGeneral,'Cambria Math','Arial Unicode MS',serif; font-style: italic; font-weight: bold}
.MJXc-TeX-ams-R {font-family: MJXc-TeX-ams-R,MJXc-TeX-ams-Rw}
.MJXc-TeX-cal-B {font-family: MJXc-TeX-cal-B,MJXc-TeX-cal-Bx,MJXc-TeX-cal-Bw}
.MJXc-TeX-frak-R {font-family: MJXc-TeX-frak-R,MJXc-TeX-frak-Rw}
.MJXc-TeX-frak-B {font-family: MJXc-TeX-frak-B,MJXc-TeX-frak-Bx,MJXc-TeX-frak-Bw}
.MJXc-TeX-math-BI {font-family: MJXc-TeX-math-BI,MJXc-TeX-math-BIx,MJXc-TeX-math-BIw}
.MJXc-TeX-sans-R {font-family: MJXc-TeX-sans-R,MJXc-TeX-sans-Rw}
.MJXc-TeX-sans-B {font-family: MJXc-TeX-sans-B,MJXc-TeX-sans-Bx,MJXc-TeX-sans-Bw}
.MJXc-TeX-sans-I {font-family: MJXc-TeX-sans-I,MJXc-TeX-sans-Ix,MJXc-TeX-sans-Iw}
.MJXc-TeX-script-R {font-family: MJXc-TeX-script-R,MJXc-TeX-script-Rw}
.MJXc-TeX-type-R {font-family: MJXc-TeX-type-R,MJXc-TeX-type-Rw}
.MJXc-TeX-cal-R {font-family: MJXc-TeX-cal-R,MJXc-TeX-cal-Rw}
.MJXc-TeX-main-B {font-family: MJXc-TeX-main-B,MJXc-TeX-main-Bx,MJXc-TeX-main-Bw}
.MJXc-TeX-main-I {font-family: MJXc-TeX-main-I,MJXc-TeX-main-Ix,MJXc-TeX-main-Iw}
.MJXc-TeX-main-R {font-family: MJXc-TeX-main-R,MJXc-TeX-main-Rw}
.MJXc-TeX-math-I {font-family: MJXc-TeX-math-I,MJXc-TeX-math-Ix,MJXc-TeX-math-Iw}
.MJXc-TeX-size1-R {font-family: MJXc-TeX-size1-R,MJXc-TeX-size1-Rw}
.MJXc-TeX-size2-R {font-family: MJXc-TeX-size2-R,MJXc-TeX-size2-Rw}
.MJXc-TeX-size3-R {font-family: MJXc-TeX-size3-R,MJXc-TeX-size3-Rw}
.MJXc-TeX-size4-R {font-family: MJXc-TeX-size4-R,MJXc-TeX-size4-Rw}
@font-face {font-family: MJXc-TeX-ams-R; src: local('MathJax_AMS'), local('MathJax_AMS-Regular')}
@font-face {font-family: MJXc-TeX-ams-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_AMS-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-B; src: local('MathJax_Caligraphic Bold'), local('MathJax_Caligraphic-Bold')}
@font-face {font-family: MJXc-TeX-cal-Bx; src: local('MathJax_Caligraphic'); font-weight: bold}
@font-face {font-family: MJXc-TeX-cal-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-R; src: local('MathJax_Fraktur'), local('MathJax_Fraktur-Regular')}
@font-face {font-family: MJXc-TeX-frak-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-frak-B; src: local('MathJax_Fraktur Bold'), local('MathJax_Fraktur-Bold')}
@font-face {font-family: MJXc-TeX-frak-Bx; src: local('MathJax_Fraktur'); font-weight: bold}
@font-face {font-family: MJXc-TeX-frak-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Fraktur-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Fraktur-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Fraktur-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-BI; src: local('MathJax_Math BoldItalic'), local('MathJax_Math-BoldItalic')}
@font-face {font-family: MJXc-TeX-math-BIx; src: local('MathJax_Math'); font-weight: bold; font-style: italic}
@font-face {font-family: MJXc-TeX-math-BIw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-BoldItalic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-BoldItalic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-BoldItalic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-R; src: local('MathJax_SansSerif'), local('MathJax_SansSerif-Regular')}
@font-face {font-family: MJXc-TeX-sans-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-B; src: local('MathJax_SansSerif Bold'), local('MathJax_SansSerif-Bold')}
@font-face {font-family: MJXc-TeX-sans-Bx; src: local('MathJax_SansSerif'); font-weight: bold}
@font-face {font-family: MJXc-TeX-sans-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-sans-I; src: local('MathJax_SansSerif Italic'), local('MathJax_SansSerif-Italic')}
@font-face {font-family: MJXc-TeX-sans-Ix; src: local('MathJax_SansSerif'); font-style: italic}
@font-face {font-family: MJXc-TeX-sans-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_SansSerif-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_SansSerif-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_SansSerif-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-script-R; src: local('MathJax_Script'), local('MathJax_Script-Regular')}
@font-face {font-family: MJXc-TeX-script-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Script-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Script-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Script-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-type-R; src: local('MathJax_Typewriter'), local('MathJax_Typewriter-Regular')}
@font-face {font-family: MJXc-TeX-type-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Typewriter-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Typewriter-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Typewriter-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-cal-R; src: local('MathJax_Caligraphic'), local('MathJax_Caligraphic-Regular')}
@font-face {font-family: MJXc-TeX-cal-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Caligraphic-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-B; src: local('MathJax_Main Bold'), local('MathJax_Main-Bold')}
@font-face {font-family: MJXc-TeX-main-Bx; src: local('MathJax_Main'); font-weight: bold}
@font-face {font-family: MJXc-TeX-main-Bw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Bold.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-I; src: local('MathJax_Main Italic'), local('MathJax_Main-Italic')}
@font-face {font-family: MJXc-TeX-main-Ix; src: local('MathJax_Main'); font-style: italic}
@font-face {font-family: MJXc-TeX-main-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-main-R; src: local('MathJax_Main'), local('MathJax_Main-Regular')}
@font-face {font-family: MJXc-TeX-main-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Main-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-math-I; src: local('MathJax_Math Italic'), local('MathJax_Math-Italic')}
@font-face {font-family: MJXc-TeX-math-Ix; src: local('MathJax_Math'); font-style: italic}
@font-face {font-family: MJXc-TeX-math-Iw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Math-Italic.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size1-R; src: local('MathJax_Size1'), local('MathJax_Size1-Regular')}
@font-face {font-family: MJXc-TeX-size1-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size1-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size2-R; src: local('MathJax_Size2'), local('MathJax_Size2-Regular')}
@font-face {font-family: MJXc-TeX-size2-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size2-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size3-R; src: local('MathJax_Size3'), local('MathJax_Size3-Regular')}
@font-face {font-family: MJXc-TeX-size3-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size3-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf') format('opentype')}
@font-face {font-family: MJXc-TeX-size4-R; src: local('MathJax_Size4'), local('MathJax_Size4-Regular')}
@font-face {font-family: MJXc-TeX-size4-Rw; src /*1*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/eot/MathJax_Size4-Regular.eot'); src /*2*/: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf') format('opentype')}
</style><script src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/alfalfa_min.d078e4f2a4721192a99e02601a767617.js" async="" charset="UTF-8"></script></head>

<body class="post-template-default single single-post postid-1327 single-format-standard has-avatars boxed header-side footer-side footer-0"><div id="MathJax_Message" style="display: none;"></div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="http://nekopuni.holy.jp/2014/11/r%E7%82%BA%E6%9B%BF%E3%82%AA%E3%83%97%E3%82%B7%E3%83%A7%E3%83%B3%E3%83%87%E3%83%BC%E3%82%BF%E3%81%8B%E3%82%89%E3%83%9C%E3%83%A9%E3%83%86%E3%82%A3%E3%83%AA%E3%83%86%E3%82%A3%E3%83%BB%E3%82%B9/#content">Skip to content</a>

	<header id="masthead" class="site-header" role="banner">
		<div class="site-top">
			<div class="site-top-table">
				<div class="site-branding">
												<h1 class="site-title"><a href="http://nekopuni.holy.jp/" rel="home">Momentum</a></h1>
												<div class="site-description">俺様備忘録です。</div>
								</div>

							</div>
		</div>

				<div class="site-bar">
			<nav id="site-navigation" class="main-navigation" role="navigation">
				<div class="menu-toggle">Menu</div>
				<div class="menu"><ul class=" nav-menu">
<li><a href="http://nekopuni.holy.jp/">Home</a></li><li class="page_item page-item-438"><a href="http://nekopuni.holy.jp/about/">About this blog</a></li>
</ul></div>
							</nav><!-- #site-navigation -->
		</div>
		
			</header><!-- #masthead -->

	<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-1327" class="post-1327 post type-post status-publish format-standard hentry category-memo tag-r">
	<header class="entry-header">
		<h1 class="entry-title">為替オプションデータからボラティリティ・スマイルを構築</h1>
			<div class="entry-meta entry-header-meta">
		<span class="posted-on">
			<a href="http://nekopuni.holy.jp/2014/11/r%e7%82%ba%e6%9b%bf%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8b%e3%82%89%e3%83%9c%e3%83%a9%e3%83%86%e3%82%a3%e3%83%aa%e3%83%86%e3%82%a3%e3%83%bb%e3%82%b9/" rel="bookmark"><time class="entry-date published updated" datetime="2014-11-16T18:15:42+00:00">16th November 2014</time></a>		</span>
						<span class="comments-link"><span class="meta-sep"> / </span> <a href="http://nekopuni.holy.jp/2014/11/r%e7%82%ba%e6%9b%bf%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8b%e3%82%89%e3%83%9c%e3%83%a9%e3%83%86%e3%82%a3%e3%83%aa%e3%83%86%e3%82%a3%e3%83%bb%e3%82%b9/#disqus_thread" data-disqus-identifier="1327 http://nekopuni.holy.jp/?p=1327">0 Comments</a></span>
					</div><!-- .entry-meta -->
				</header><!-- .entry-header -->

	<div class="entry-content">
		<h3>概要</h3>
<p>・為替オプションのボラティリティデータからボラティリティ・スマイルをキャリブレーションする<br>
・Polynominal in deltaとSABRの2種類を計算</p>
<h3>背景</h3>
<p>・ボラティリティスマイルの存在<br>
一般的にインプライド・ボラティリティは行使価格により異なる値がマークされており、行使価格とインプライド・ボラティリティを繋げる<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-1-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 109%; position: relative;"><span id="MJXc-Node-1" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-2" class="mjx-mrow"><span id="MJXc-Node-3" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.2em; padding-bottom: 0.265em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-4" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-5" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.462em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-6" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.462em; padding-bottom: 0.265em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-7" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.462em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mrow><mo>(</mo><mi>K</mi><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1"> \sigma \left( K \right) </script>という関数を見つけることがプライシング、またリスク管理上重要です。<br>
ATMのボラティリティだけ見て、OTMを評価しようとすると痛い目を見ますよということですな。</p>
<p>株式オプションの場合などには、いくつかの行使価格ごとにオプションが存在することから容易に<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-2-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 109%; position: relative;"><span id="MJXc-Node-8" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-9" class="mjx-mrow"><span id="MJXc-Node-10" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.2em; padding-bottom: 0.265em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-11" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-12" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.462em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-13" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.462em; padding-bottom: 0.265em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-14" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.462em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mrow><mo>(</mo><mi>K</mi><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-2"> \sigma \left( K \right) </script>を推定することができる一方、為替オプションの場合には、<br>
・ATMインプライド・ボラティリティ<br>
・リスクリバーサル(10デルタ、25デルタ)<br>
→ コールとプットの差に相当し、スマイルのスキューを表す<br>
・ストラングル(10デルタ、25デルタ)<br>
→ コール + プット – ATMに相当し、スマイルの曲率を表す<br>
の情報のみがマーケットに与えられています。したがって、これらの情報と整合的なようにボラティリティ・スマイル<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span id="MathJax-Element-3-Frame" class="mjx-chtml MathJax_CHTML" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x03C3;&lt;/mi&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mi&gt;K&lt;/mi&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="font-size: 109%; position: relative;"><span id="MJXc-Node-15" class="mjx-math" aria-hidden="true"><span id="MJXc-Node-16" class="mjx-mrow"><span id="MJXc-Node-17" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.2em; padding-bottom: 0.265em; padding-right: 0.001em;">σ</span></span><span id="MJXc-Node-18" class="mjx-mrow MJXc-space1"><span id="MJXc-Node-19" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.462em; padding-bottom: 0.593em;">(</span></span><span id="MJXc-Node-20" class="mjx-mi"><span class="mjx-char MJXc-TeX-math-I" style="padding-top: 0.462em; padding-bottom: 0.265em; padding-right: 0.04em;">K</span></span><span id="MJXc-Node-21" class="mjx-mo"><span class="mjx-char MJXc-TeX-main-R" style="padding-top: 0.462em; padding-bottom: 0.593em;">)</span></span></span></span></span><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>σ</mi><mrow><mo>(</mo><mi>K</mi><mo>)</mo></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3"> \sigma \left( K \right) </script>を推定しなければなりません。</p>
<p>今回は参考文献にも記載されているPolynominal in deltaという方法と、SABRの2種類を実際にRを使って計算してみたいと思います。<br>
今回はその中でも、ATMと25デルタの3点の情報を使ってスマイルを構築してみたいと思います。</p>
<p>マーケットには10デルタの情報もあるので、この5点を使ってスマイルを構築するという方法もありますが、それはまた別のお話ということで</p>
<h3>前準備、データなど</h3>
<p>基本的には参考文献3章に記載されているデータを使用しています。<br>
対象はユーロドルの1年のオプションデータです。<br>
為替オプションの場合、一口にデルタと言っても様々な表現方法があります。ユーロドルの1年の場合にはPip spotという方式になります。この方式に関しては通貨ペアの種類や、年限にも依存するので詳細は参考文献参照ということで汗</p>
<p>pip spotの方式に従う場合、ATMの行使価格はgetATMStrike()関数に記載されているような式で計算することが出来ます。<br>
また、Polynominal in delta、SABRの両手法で共通する部分関してはCalibrationと書いてある以下の部分で計算しています。<br>
具体的にはATMの行使価格、マーケットストラングルの行使価格、オプション価値の総和ですね。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c27c4e0efcb3042120242" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden; height: 1056px;">library(pipeR)
library(powell)


#-------------------------------------------------------------------
# Initial settings for EURUSD 1y
#-------------------------------------------------------------------
r_for &lt;- 0.03446
r_dom &lt;- 0.0294
spot &lt;- 1.3465
tau &lt;- 1
pips &lt;- 4
forward &lt;- (spot * exp((r_dom - r_for) * tau)) %&gt;&gt;% {round(., pips)}
deltaType &lt;- "pipspot"

vol_atm &lt;- 0.1825
vol_25ms &lt;- 0.0095 #market strangle
vol_25rr &lt;- -0.006 #risk reversal

#-------------------------------------------------------------------
# Functions
#-------------------------------------------------------------------
getD &lt;- function(forward, strike, vol, tau, flg){
  #flg = 1 or -1
  return((log(forward/strike) + flg * 0.5 * vol^2 * tau)/(vol * sqrt(tau)))
}

getDelta &lt;- function(deltaType, callput, r_for, forward, strike, vol, tau){
  #callput = 1 for call, -1 for put
  if(tolower(deltaType) == "pipspot"){
    d1 &lt;- getD(forward, strike, vol, tau, 1)
    return(callput * exp(-r_for * tau) * pnorm(callput * d1))
  }
}

getOptionValue &lt;- function(callput, spot, forward, r_for, r_dom, strike, vol, tau){
  #callput = 1 for call, -1 for put
  d1 &lt;- getD(forward, strike, vol, tau, 1)
  d2 &lt;- getD(forward, strike, vol, tau, -1)
  return(
    callput * spot * exp(-r_for * tau) * pnorm(callput * d1) -
      callput * strike * exp(-r_dom * tau) * pnorm(callput * d2)
  )
}

getATMStrike &lt;- function(deltaType, forward, vol, tau){
  if(tolower(deltaType) == "pipspot"){
    return(forward * exp(0.5 * vol^2 * tau))
  }
}

#-------------------------------------------------------------------
# Calibration
#-------------------------------------------------------------------
k_atm &lt;- getATMStrike(deltaType, forward, vol_atm, tau) %&gt;&gt;% {round(., pips)}

k_25c_ms &lt;- uniroot(function(x){
  return(
    getDelta(deltaType, 1, r_for, forward, x, vol_atm + vol_25ms, tau) - 0.25
  )
}, c(0, 100))$root %&gt;&gt;% {round(., pips)}

k_25p_ms &lt;- uniroot(function(x){
  return(
    getDelta(deltaType, -1, r_for, forward, x, vol_atm + vol_25ms, tau) + 0.25
  )
}, c(0, 100))$root %&gt;&gt;% {round(., pips)}

v_25_ms &lt;- getOptionValue(-1, spot, forward, r_for, r_dom, k_25p_ms, vol_atm + vol_25ms, tau) +
  getOptionValue(1, spot, forward, r_for, r_dom, k_25c_ms, vol_atm + vol_25ms, tau)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden; opacity: 1;">
				<table class="crayon-table" style="margin-left: 0px;">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-2">2</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-4">4</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-6">6</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-8">8</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-10">10</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-12">12</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-14">14</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-16">16</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-18">18</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-20">20</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-22">22</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-24">24</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-26">26</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-28">28</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-30">30</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-32">32</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-34">34</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-36">36</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-38">38</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-40">40</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-42">42</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-44">44</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-46">46</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-48">48</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-50">50</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-52">52</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-54">54</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-56">56</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-58">58</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-60">60</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-62">62</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-64">64</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-66">66</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-68">68</div><div class="crayon-num" data-line="crayon-5c27c4e0efcb3042120242-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcb3042120242-70">70</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-1"><span class="crayon-r">library</span><span class="crayon-sy">(</span><span class="crayon-v">pipeR</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-2"><span class="crayon-r">library</span><span class="crayon-sy">(</span><span class="crayon-v">powell</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-4">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-5"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-6"><span class="crayon-c"># Initial settings for EURUSD 1y</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-7"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-8"><span class="crayon-v">r_for</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.03446</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-9"><span class="crayon-v">r_dom</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.0294</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-10"><span class="crayon-v">spot</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1.3465</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-11"><span class="crayon-v">tau</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-12"><span class="crayon-v">pips</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">4</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-13"><span class="crayon-v">forward</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">spot</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">r_dom</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pips</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-14"><span class="crayon-v">deltaType</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-s">"pipspot"</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-15">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-16"><span class="crayon-v">vol_atm</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.1825</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-17"><span class="crayon-v">vol_25ms</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.0095</span><span class="crayon-h"> </span><span class="crayon-c">#market strangle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-18"><span class="crayon-v">vol_25rr</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">0.006</span><span class="crayon-h"> </span><span class="crayon-c">#risk reversal</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-19">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-20"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-21"><span class="crayon-c"># Functions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-22"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-23"><span class="crayon-v">getD</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">flg</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-24"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">#flg = 1 or -1</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-25"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-o">/</span><span class="crayon-v">strike</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">flg</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">vol</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-v">vol</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-26"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-27">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-28"><span class="crayon-v">getDelta</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">callput</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-29"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">#callput = 1 for call, -1 for put</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-30"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-e">tolower</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"pipspot"</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">d1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getD</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-32"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">callput</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">r_for</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">pnorm</span><span class="crayon-sy">(</span><span class="crayon-v">callput</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">d1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-33"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-34"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-36"><span class="crayon-v">getOptionValue</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">callput</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spot</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_dom</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-37"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-c">#callput = 1 for call, -1 for put</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">d1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getD</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-39"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">d2</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getD</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-40"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">callput</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">spot</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">r_for</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">pnorm</span><span class="crayon-sy">(</span><span class="crayon-v">callput</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">d1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">callput</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-v">r_dom</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">pnorm</span><span class="crayon-sy">(</span><span class="crayon-v">callput</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">d2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-43"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-44"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-45">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-46"><span class="crayon-v">getATMStrike</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-47"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-e">tolower</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-s">"pipspot"</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">vol</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-49"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-50"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-51">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-52"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-53"><span class="crayon-c"># Calibration</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-54"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-55"><span class="crayon-v">k_atm</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getATMStrike</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol_atm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pips</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-56">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-57"><span class="crayon-v">k_25c_ms</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">uniroot</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-58"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">getDelta</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol_atm</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-60"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-61"><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">$</span><span class="crayon-e">root</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pips</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-62">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-63"><span class="crayon-v">k_25p_ms</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">uniroot</span><span class="crayon-sy">(</span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-64"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">getDelta</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol_atm</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-66"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-67"><span class="crayon-sy">}</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">$</span><span class="crayon-e">root</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">pips</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-68">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcb3042120242-69"><span class="crayon-v">v_25_ms</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getOptionValue</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spot</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_dom</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25p_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol_atm</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcb3042120242-70"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">getOptionValue</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spot</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_dom</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25c_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol_atm</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0227 seconds] -->
<p>
</p>
<h3>Polynominal in delta</h3>
<p>さて上記の情報を元に、キャリブレーションをするわけです。<br>
Polynominal in deltaに関しては名前の通り多項式関数でスマイルを構築します。2次関数でキャリブレーションしますので推定するパラメータはc0, c1, c2となります。<br>
この3つのパラメータと同時に、スマイルストラングルというパラメータ(2つの行使価格)も推定します。</p>
<p>さらに、マーケットでクオートされているATM、リスクリバーサルの情報も満たすように制約条件を加えてあげますと以下の様な感じでしょうか。whileループの中に式番号が振ってありますがこれは参考文献の中で記載されている制約条件に対応しています。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c27c4e0efcc3177959938" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">polynominalInDelta &lt;- function(strike, forward, tau, c0, c1, c2){
  delta0 &lt;- exp(c0)
 
  delta &lt;- function(x){
    return(pnorm(x/(delta0 * sqrt(tau))))
  }
 
  f &lt;- function(x){
    return(c0 + c1 * delta(x) + c2 * delta(x)^2)
  }
 
  return(exp(f(log(forward/strike))))
}

#-------------------------------------------------------------------
# Polynominal In Delta
#-------------------------------------------------------------------
itr &lt;- 0
tol &lt;- 1e-10
adj &lt;- 1e-7
vol_25ss &lt;- vol_25ms #initial guess for smile strangle
error &lt;- 1
par_calibration &lt;- c(0, 0, 0, k_25c_ms, k_25p_ms) #initial parameters

while(error &gt; tol){
  fn &lt;- function(args){
    c0 &lt;- args[1]
    c1 &lt;- args[2]
    c2 &lt;- args[3]
    k_25c &lt;- args[4]
    k_25p &lt;- args[5]
   
    #residuals
    #eq 3.18 - ATM vol
    res1 &lt;- (polynominalInDelta(k_atm, forward, tau, c0, c1, c2) - vol_atm)^2
   
    #eq 3.19 - risk reversal
    res2 &lt;- (polynominalInDelta(k_25c, forward, tau, c0, c1, c2) -
      polynominalInDelta(k_25p, forward, tau, c0, c1, c2) - vol_25rr)^2
   
    #eq 3.20 - smile strangle
    res3 &lt;- (0.5 * (polynominalInDelta(k_25c, forward, tau, c0, c1, c2) +
      polynominalInDelta(k_25p, forward, tau, c0, c1, c2)) -
      polynominalInDelta(k_atm, forward, tau, c0, c1, c2) - vol_25ss)^2
   
    #eq 3.14 - 25delta
    res4 &lt;- (getDelta(deltaType, -1, r_for, forward, k_25p, polynominalInDelta(k_25p, forward, tau, c0, c1, c2), tau) + 0.25)^2
    res5 &lt;- (getDelta(deltaType, 1, r_for, forward, k_25c, polynominalInDelta(k_25c, forward, tau, c0, c1, c2), tau) - 0.25)^2
   
    return(res1 + res2 + res3 + res4 + res5)
  }
 
  par_calibration &lt;- powell(par_calibration, fn)$par
 
  vol_25c_ms &lt;- polynominalInDelta(k_25c_ms, forward, tau, par_calibration[1], par_calibration[2], par_calibration[3])
  vol_25p_ms &lt;- polynominalInDelta(k_25p_ms, forward, tau, par_calibration[1], par_calibration[2], par_calibration[3])
  v_trial &lt;- getOptionValue(1, spot, forward, r_for, r_dom, k_25c_ms, vol_25c_ms, tau) +
    getOptionValue(-1, spot, forward, r_for, r_dom, k_25p_ms, vol_25p_ms, tau)
 
  error &lt;- v_trial - v_25_ms
 
  if(error &gt; 0){
    vol_25ss &lt;- vol_25ss - adj
  }else{
    vol_25ss &lt;- vol_25ss + adj
  }
 
  cat(itr, error, par_calibration, "\n")
 
  itr &lt;- itr + 1
}

#save parameters
par_polynominalInDelta &lt;- par_calibration

#check risk reversal
(polynominalInDelta(par_polynominalInDelta[4], forward, tau, par_polynominalInDelta[1], par_polynominalInDelta[2], par_polynominalInDelta[3]) -
  polynominalInDelta(par_polynominalInDelta[5], forward, tau, par_polynominalInDelta[1], par_polynominalInDelta[2], par_polynominalInDelta[3])) %&gt;&gt;%
  {round(., 4)}

#check market strangle
v_25_ms
v_trial

#volatility smile using PolynominalInDelta
strike &lt;- seq(from = 1, to = 2, by = 0.01)
mapply(polynominalInDelta, strike, forward, tau, par_polynominalInDelta[1], par_polynominalInDelta[2], par_polynominalInDelta[3]) %&gt;&gt;%
{cbind(strike, .)} %&gt;&gt;%
{plot(., type="l", xlab="Strike", ylab="Volatility", main="Volatility smile using Polynominal In Delta for EURUSD")}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-2">2</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-4">4</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-6">6</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-8">8</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-10">10</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-12">12</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-14">14</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-16">16</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-18">18</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-20">20</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-22">22</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-24">24</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-26">26</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-28">28</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-30">30</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-32">32</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-34">34</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-36">36</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-38">38</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-40">40</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-42">42</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-44">44</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-46">46</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-48">48</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-50">50</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-52">52</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-54">54</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-56">56</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-58">58</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-60">60</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-62">62</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-64">64</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-66">66</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-68">68</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-70">70</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-72">72</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-74">74</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-76">76</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-78">78</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-80">80</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-82">82</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-84">84</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-86">86</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcc3177959938-88">88</div><div class="crayon-num" data-line="crayon-5c27c4e0efcc3177959938-89">89</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-1"><span class="crayon-v">polynominalInDelta</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">delta0</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">c0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-3"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-4"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">delta</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-e">pnorm</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-o">/</span><span class="crayon-sy">(</span><span class="crayon-v">delta0</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-7"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-t ">f</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">c0</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">delta</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">delta</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-11"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-12"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-t ">f</span><span class="crayon-sy">(</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-o">/</span><span class="crayon-v">strike</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-13"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-14">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-15"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-16"><span class="crayon-c"># Polynominal In Delta</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-17"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-18"><span class="crayon-v">itr</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-19"><span class="crayon-v">tol</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-20"><span class="crayon-v">adj</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-21"><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ms</span><span class="crayon-h"> </span><span class="crayon-c">#initial guess for smile strangle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-22"><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-23"><span class="crayon-v">par_calibration</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25c_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25p_ms</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">#initial parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-24">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-25"><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-26"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">fn</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-27"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">c0</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-28"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">c1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-29"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">c2</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-30"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">k_25c</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-31"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">k_25p</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-32"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-33"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#residuals</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-34"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#eq 3.18 - ATM vol</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-35"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_atm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_atm</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-36"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-37"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#eq 3.19 - risk reversal</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-38"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res2</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_25c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_25p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25rr</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-40"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#eq 3.20 - smile strangle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_25c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_25p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-44"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_atm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ss</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-45"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#eq 3.14 - 25delta</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res4</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">getDelta</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_25p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-48"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res5</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">getDelta</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_25c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">c2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-49"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">res1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">res2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">res3</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">res4</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">res5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-51"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-52"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-53"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">par_calibration</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">powell</span><span class="crayon-sy">(</span><span class="crayon-v">par_calibration</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fn</span><span class="crayon-sy">)</span><span class="crayon-sy">$</span><span class="crayon-e">par</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-54"><span class="crayon-e"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-55"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">vol_25c_ms</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_25c_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-56"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">vol_25p_ms</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">k_25p_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-57"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">v_trial</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getOptionValue</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spot</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_dom</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25c_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol_25c_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">getOptionValue</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spot</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_dom</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25p_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol_25p_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-59"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-60"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v_trial</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">v_25_ms</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-61"><span class="crayon-e"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-62"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">adj</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-64"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-st">else</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-65"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">adj</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-66"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-67"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-68"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">cat</span><span class="crayon-sy">(</span><span class="crayon-v">itr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_calibration</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-69"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-70"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">itr</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">itr</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-71"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-72">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-73"><span class="crayon-c">#save parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-74"><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">par_calibration</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-75">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-76"><span class="crayon-c">#check risk reversal</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-77"><span class="crayon-sy">(</span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-78"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">polynominalInDelta</span><span class="crayon-sy">(</span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-79"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-80">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-81"><span class="crayon-c">#check market strangle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-82"><span class="crayon-e">v_25_ms</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-83"><span class="crayon-v">v_trial</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-84">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-85"><span class="crayon-c">#volatility smile using PolynominalInDelta</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-86"><span class="crayon-v">strike</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-v">from</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">by</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-87"><span class="crayon-e">mapply</span><span class="crayon-sy">(</span><span class="crayon-v">polynominalInDelta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcc3177959938-88"><span class="crayon-sy">{</span><span class="crayon-e">cbind</span><span class="crayon-sy">(</span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line" id="crayon-5c27c4e0efcc3177959938-89"><span class="crayon-sy">{</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"l"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xlab</span><span class="crayon-o">=</span><span class="crayon-s">"Strike"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ylab</span><span class="crayon-o">=</span><span class="crayon-s">"Volatility"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">main</span><span class="crayon-o">=</span><span class="crayon-s">"Volatility smile using Polynominal In Delta for EURUSD"</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0171 seconds] -->
<p> </p>
<p>推定結果を見てみますと、</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c27c4e0efcce905124916" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt; par_polynominalInDelta
[1] -1.460950 -1.085826 1.223140 1.541246 1.203552</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c27c4e0efcce905124916-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcce905124916-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c27c4e0efcce905124916-1"><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">par</span><span class="crayon-sy">_</span>polynominalInDelta</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcce905124916-2"><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1.460950</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1.085826</span><span class="crayon-h"> </span><span class="crayon-cn">1.223140</span><span class="crayon-h"> </span><span class="crayon-cn">1.541246</span><span class="crayon-h"> </span><span class="crayon-cn">1.203552</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p> </p>
<p>となり、左から、c0, c1, c2, k_25c, k_25pとなります。<br>
c0, c1, c2に関しては参考文献の推定結果と異なりますが、k_25c, k_25pに関してはそれらしい値が推定されていることが分かります。</p>
<p>また、リスクリバーサル、及びストラングルの制約を満たしていることが分かります。<br>
推定されたパラメータからボラティリティ・スマイルを構築してみると以下。</p>
<p><a href="http://nekopuni.holy.jp/wp-content/uploads/2014/11/141116_1.png" class="fancybox"><img src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/141116_1-287x300.png" alt="141116_1" width="287" height="300" class="alignleft size-medium wp-image-1328" srcset="http://nekopuni.holy.jp/wp-content/uploads/2014/11/141116_1-287x300.png 287w, http://nekopuni.holy.jp/wp-content/uploads/2014/11/141116_1.png 600w" sizes="(max-width: 287px) 100vw, 287px"></a></p>
<h3>SABR</h3>
<p>ここで、polynominal in deltaと別の方法である、SABRという方法も試してみます。<br>
あとで分かることですが、polynominal in deltaはdeep out of the moneyで十分なインプライドボラティリティを持たせることが出来ないという欠点があります。<br>
そこを克服する方法がSABRとなるわけですな。<br>
求めるパラメータはalpha, volvol, rho, betaの4つとなります。この中のbetaに関しては外生的に固定値を与えるやり方がオシャレなようでして、参考文献でもbeta = 1で固定しています。今回のコードもそれを踏襲。<br>
また、alpha, volvolは非負制約、rhoは相関係数で[-1, 1]の制約があります。それを満たすように、前者はexpを、後者はtanhをかませています。</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c27c4e0efcd5761007784" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">sabr &lt;- function(strike, forward, tau, alpha, volvol, rho, beta){
  xi &lt;- function(x){
    numerator &lt;- sqrt(1 - 2 * rho * x + x^2) + x - rho
    denominator &lt;- 1 - rho
    return(log(numerator / denominator))
  }
 
  z &lt;- volvol / alpha * (forward * strike)^((1 - beta)/2) * log(forward / strike)
 
  ret1_denominator &lt;- (forward * strike)^((1 - beta) / 2) *
    (1 + ((1 - beta)^2/24) * (log(forward / strike))^2 +
       ((1 - beta)^4/1920) * (log(forward / strike))^4)
  ret1 &lt;- alpha / ret1_denominator
 
  ret2 &lt;- z / xi(z)
 
  ret3 &lt;- ((1 - beta)^2)/24 * alpha^2 / ((forward * strike)^(1 - beta)) +
    1/4 * (rho * beta * volvol* alpha) / ((forward * strike)^((1 - beta)/2)) +
    (2 - 3 * rho^2)/24 * volvol^2
  ret3 &lt;- 1 + ret3 * tau
 
  return(ret1 * ret2 * ret3)
}

#-------------------------------------------------------------------
# SABR
#-------------------------------------------------------------------
itr &lt;- 0
tol &lt;- 1e-10
adj &lt;- 1e-7
vol_25ss &lt;- vol_25ms #initial guess for smile strangle
error &lt;- 1
par_calibration &lt;- c(-1, -1, 0, k_25c_ms, k_25p_ms) #initial parameters

while(error &gt; tol){
 
  beta &lt;- 1 #const
  fn &lt;- function(args){
    alpha &lt;- args[1]
    volvol &lt;- args[2]
    rho &lt;- args[3]
    k_25c &lt;- args[4]
    k_25p &lt;- args[5]
   
    alpha &lt;- exp(alpha)
    volvol &lt;- exp(volvol)
    rho &lt;- tanh(rho)
   
    #residuals
    #eq 3.18 - ATM vol
    res1 &lt;- (sabr(k_atm, forward, tau, alpha, volvol, rho, beta) - vol_atm)^2
   
    #eq 3.19 - risk reversal
    res2 &lt;- (sabr(k_25c, forward, tau, alpha, volvol, rho, beta) -
               sabr(k_25p, forward, tau, alpha, volvol, rho, beta) - vol_25rr)^2
   
    #eq 3.20 - smile strangle
    res3 &lt;- (0.5 * (sabr(k_25c, forward, tau, alpha, volvol, rho, beta) +
                      sabr(k_25p, forward, tau, alpha, volvol, rho, beta)) -
               sabr(k_atm, forward, tau, alpha, volvol, rho, beta) - vol_25ss)^2
   
    #eq 3.14 - 25delta
    res4 &lt;- (getDelta(deltaType, -1, r_for, forward, k_25p, sabr(k_25p, forward, tau, alpha, volvol, rho, beta), tau) + 0.25)^2
    res5 &lt;- (getDelta(deltaType, 1, r_for, forward, k_25c, sabr(k_25c, forward, tau, alpha, volvol, rho, beta), tau) - 0.25)^2
   
    return(res1 + res2 + res3 + res4 + res5)
  }
 
  par_calibration &lt;- powell(par_calibration, fn)$par
 
 
  vol_25c_ms &lt;- sabr(k_25c_ms, forward, tau, exp(par_calibration[1]), exp(par_calibration[2]), tanh(par_calibration[3]), beta)
  vol_25p_ms &lt;- sabr(k_25p_ms, forward, tau, exp(par_calibration[1]), exp(par_calibration[2]), tanh(par_calibration[3]), beta)
  v_trial &lt;- getOptionValue(1, spot, forward, r_for, r_dom, k_25c_ms, vol_25c_ms, tau) +
    getOptionValue(-1, spot, forward, r_for, r_dom, k_25p_ms, vol_25p_ms, tau)
 
  error &lt;- v_trial - v_25_ms
 
  if(error &gt; 0){
    vol_25ss &lt;- vol_25ss - adj
  }else{
    vol_25ss &lt;- vol_25ss + adj
  }
 
  cat(itr, error, par_calibration, "\n")
 
  itr &lt;- itr + 1
}

#save parameters
par_sabr &lt;- par_calibration
cat(exp(par_sabr[1]), exp(par_sabr[2]), tanh(par_sabr[3]))

#check risk reversal
(sabr(par_sabr[4], forward, tau, exp(par_sabr[1]), exp(par_sabr[2]), tanh(par_sabr[3]), 1) -
   sabr(par_sabr[5], forward, tau, exp(par_sabr[1]), exp(par_sabr[2]), tanh(par_sabr[3]), 1)) %&gt;&gt;%
{round(., 4)}

#check market strangle
v_25_ms
v_trial

#volatility smile using SABR
strike &lt;- seq(from = 1, to = 2, by = 0.01)
mapply(sabr, strike, forward, tau, exp(par_sabr[1]), exp(par_sabr[2]), tanh(par_sabr[3]), 1) %&gt;&gt;%
{cbind(strike, .)} %&gt;&gt;%
{plot(., type="l", xlab="Strike", ylab="Volatility", main="Volatility smile using SABR for EURUSD")}</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-2">2</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-4">4</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-6">6</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-8">8</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-10">10</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-12">12</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-14">14</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-16">16</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-18">18</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-20">20</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-22">22</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-24">24</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-26">26</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-28">28</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-30">30</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-32">32</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-34">34</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-36">36</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-38">38</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-40">40</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-42">42</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-44">44</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-46">46</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-48">48</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-50">50</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-52">52</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-54">54</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-56">56</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-58">58</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-60">60</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-62">62</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-64">64</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-66">66</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-68">68</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-69">69</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-70">70</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-72">72</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-74">74</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-76">76</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-78">78</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-80">80</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-82">82</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-84">84</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-86">86</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-88">88</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-90">90</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-92">92</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-94">94</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-96">96</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-98">98</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-100">100</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-102">102</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-104">104</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efcd5761007784-106">106</div><div class="crayon-num" data-line="crayon-5c27c4e0efcd5761007784-107">107</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-1"><span class="crayon-v">sabr</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-2"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">xi</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">sqrt</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">rho</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-4"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">denominator</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">rho</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-5"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">numerator</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">denominator</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-7"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-8"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-9"><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">ret1_denominator</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-11"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-o">/</span><span class="crayon-cn">24</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">4</span><span class="crayon-o">/</span><span class="crayon-cn">1920</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">log</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">4</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-13"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">ret1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">ret1_denominator</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-14"><span class="crayon-e"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-15"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">ret2</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">z</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-e">xi</span><span class="crayon-sy">(</span><span class="crayon-v">z</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-16"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-17"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">ret3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-cn">24</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-18"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">4</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">rho</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">forward</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-19"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">(</span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-o">^</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-o">/</span><span class="crayon-cn">24</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-20"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">ret3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">ret3</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">tau</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-21"><span class="crayon-e"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-22"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">ret1</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ret2</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">ret3</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-23"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-24">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-25"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-26"><span class="crayon-c"># SABR</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-27"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-28"><span class="crayon-v">itr</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-29"><span class="crayon-v">tol</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">10</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-30"><span class="crayon-v">adj</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1e</span><span class="crayon-o">-</span><span class="crayon-cn">7</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-31"><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ms</span><span class="crayon-h"> </span><span class="crayon-c">#initial guess for smile strangle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-32"><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-33"><span class="crayon-v">par_calibration</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25c_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25p_ms</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-c">#initial parameters</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-34">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-35"><span class="crayon-st">while</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">tol</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-36"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-37"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">beta</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-h"> </span><span class="crayon-c">#const</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-38"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">fn</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-t">function</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-39"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-40"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">volvol</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-41"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rho</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-42"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">k_25c</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-43"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">k_25p</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-44"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-45"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">alpha</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">alpha</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-46"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">volvol</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">volvol</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-47"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">rho</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">tanh</span><span class="crayon-sy">(</span><span class="crayon-v">rho</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-48"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-49"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#residuals</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-50"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#eq 3.18 - ATM vol</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-51"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res1</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_atm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_atm</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-52"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-53"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#eq 3.19 - risk reversal</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-54"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res2</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_25c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-55"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_25p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25rr</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-56"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-57"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#eq 3.20 - smile strangle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-58"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res3</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0.5</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_25c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-59"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_25p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-60"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_atm</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ss</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-61"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-62"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-c">#eq 3.14 - 25delta</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-63"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res4</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">getDelta</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_25p</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-64"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">res5</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-e">getDelta</span><span class="crayon-sy">(</span><span class="crayon-v">deltaType</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_25c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">alpha</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">volvol</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">rho</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">0.25</span><span class="crayon-sy">)</span><span class="crayon-o">^</span><span class="crayon-cn">2</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-65"><span class="crayon-h">&nbsp;&nbsp; </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-66"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-sy">(</span><span class="crayon-v">res1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">res2</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">res3</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">res4</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">res5</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-67"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-68"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-69"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">par_calibration</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">powell</span><span class="crayon-sy">(</span><span class="crayon-v">par_calibration</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fn</span><span class="crayon-sy">)</span><span class="crayon-sy">$</span><span class="crayon-e">par</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-70"><span class="crayon-e"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-71"><span class="crayon-e"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-72"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-v">vol_25c_ms</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_25c_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">tanh</span><span class="crayon-sy">(</span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-73"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">vol_25p_ms</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">k_25p_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">tanh</span><span class="crayon-sy">(</span><span class="crayon-v">par_calibration</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">beta</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-74"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">v_trial</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">getOptionValue</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spot</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_dom</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25c_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol_25c_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-75"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">getOptionValue</span><span class="crayon-sy">(</span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">spot</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_for</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">r_dom</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">k_25p_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">vol_25p_ms</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-76"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-77"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">v_trial</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">v_25_ms</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-78"><span class="crayon-e"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-79"><span class="crayon-e">&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-sy">(</span><span class="crayon-v">error</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-80"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-i">adj</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-81"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span><span class="crayon-st">else</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-82"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">vol_25ss</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-i">adj</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-83"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-84"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-85"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-e">cat</span><span class="crayon-sy">(</span><span class="crayon-v">itr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_calibration</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"\n"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-86"><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-87"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-v">itr</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">itr</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-88"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-89">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-90"><span class="crayon-c">#save parameters</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-91"><span class="crayon-v">par_sabr</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">par_calibration</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-92"><span class="crayon-e">cat</span><span class="crayon-sy">(</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">tanh</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-93">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-94"><span class="crayon-c">#check risk reversal</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-95"><span class="crayon-sy">(</span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">4</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">tanh</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-96"><span class="crayon-h">&nbsp;&nbsp; </span><span class="crayon-e">sabr</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">5</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">tanh</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-97"><span class="crayon-sy">{</span><span class="crayon-e">round</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-98">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-99"><span class="crayon-c">#check market strangle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-100"><span class="crayon-e">v_25_ms</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-101"><span class="crayon-v">v_trial</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-102">&nbsp;</div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-103"><span class="crayon-c">#volatility smile using SABR</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-104"><span class="crayon-v">strike</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-v">from</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">by</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-105"><span class="crayon-e">mapply</span><span class="crayon-sy">(</span><span class="crayon-v">sabr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">tanh</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efcd5761007784-106"><span class="crayon-sy">{</span><span class="crayon-e">cbind</span><span class="crayon-sy">(</span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line" id="crayon-5c27c4e0efcd5761007784-107"><span class="crayon-sy">{</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"l"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xlab</span><span class="crayon-o">=</span><span class="crayon-s">"Strike"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ylab</span><span class="crayon-o">=</span><span class="crayon-s">"Volatility"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">main</span><span class="crayon-o">=</span><span class="crayon-s">"Volatility smile using SABR for EURUSD"</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0237 seconds] -->
<p> </p>
<p>で、推定されたパラメータがこちら</p>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c27c4e0efce0430001419" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">&gt; cat(exp(par_sabr[1]), exp(par_sabr[2]), tanh(par_sabr[3]))
0.1743092 0.8170068 -0.1126741</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c27c4e0efce0430001419-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efce0430001419-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c27c4e0efce0430001419-1"><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-e">cat</span><span class="crayon-sy">(</span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">tanh</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efce0430001419-2"><span class="crayon-cn">0.1743092</span><span class="crayon-h"> </span><span class="crayon-cn">0.8170068</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">0.1126741</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p> </p>
<p>ということで、こちらも全く参考文献と同じというわけではありませんが、似たような値が出てきます。</p>
<p>また、結果は割愛しますがSABRでの推定結果もリスクリバーサル、ストラングルの条件を満たしています。<br>
スマイルの形状は以下。</p>
<p><a href="http://nekopuni.holy.jp/wp-content/uploads/2014/11/141116_2.png" class="fancybox"><img src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/141116_2-287x300.png" alt="141116_2" width="287" height="300" class="alignleft size-medium wp-image-1329" srcset="http://nekopuni.holy.jp/wp-content/uploads/2014/11/141116_2-287x300.png 287w, http://nekopuni.holy.jp/wp-content/uploads/2014/11/141116_2.png 600w" sizes="(max-width: 287px) 100vw, 287px"></a>
</p>
<h3>両手法の比較</h3>
<p></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5c27c4e0efce6686861548" class="crayon-syntax crayon-theme-familiar crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover" style="font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">R</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">#-------------------------------------------------------------------
# Compare the results
#-------------------------------------------------------------------
strike &lt;- seq(from = 0.5, to = 2, by = 0.01)
mapply(polynominalInDelta, strike, forward, tau, par_polynominalInDelta[1], par_polynominalInDelta[2], par_polynominalInDelta[3]) %&gt;&gt;%
  {cbind(strike, .)} %&gt;&gt;%
  {plot(., type="l", xlab="Strike", ylab="Volatility", main="Volatility smile for EURUSD 1y", ylim=c(0.18, 0.4))}
mapply(sabr, strike, forward, tau, exp(par_sabr[1]), exp(par_sabr[2]), tanh(par_sabr[3]), 1) %&gt;&gt;%
  {cbind(strike, .)} %&gt;&gt;%
  {lines(., type="l", col=2)}
legend("topright", legend=c("polynominal", "SABR"), col=c(1, 2), lty=c(1, 1), bty="n")</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5c27c4e0efce6686861548-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efce6686861548-2">2</div><div class="crayon-num" data-line="crayon-5c27c4e0efce6686861548-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efce6686861548-4">4</div><div class="crayon-num" data-line="crayon-5c27c4e0efce6686861548-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efce6686861548-6">6</div><div class="crayon-num" data-line="crayon-5c27c4e0efce6686861548-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efce6686861548-8">8</div><div class="crayon-num" data-line="crayon-5c27c4e0efce6686861548-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5c27c4e0efce6686861548-10">10</div><div class="crayon-num" data-line="crayon-5c27c4e0efce6686861548-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5c27c4e0efce6686861548-1"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efce6686861548-2"><span class="crayon-c"># Compare the results</span></div><div class="crayon-line" id="crayon-5c27c4e0efce6686861548-3"><span class="crayon-c">#-------------------------------------------------------------------</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efce6686861548-4"><span class="crayon-v">strike</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-e">seq</span><span class="crayon-sy">(</span><span class="crayon-v">from</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-st">to</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">by</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0.01</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5c27c4e0efce6686861548-5"><span class="crayon-e">mapply</span><span class="crayon-sy">(</span><span class="crayon-v">polynominalInDelta</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">par_polynominalInDelta</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efce6686861548-6"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-e">cbind</span><span class="crayon-sy">(</span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line" id="crayon-5c27c4e0efce6686861548-7"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-e">plot</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"l"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">xlab</span><span class="crayon-o">=</span><span class="crayon-s">"Strike"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ylab</span><span class="crayon-o">=</span><span class="crayon-s">"Volatility"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">main</span><span class="crayon-o">=</span><span class="crayon-s">"Volatility smile for EURUSD 1y"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">ylim</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-cn">0.18</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.4</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efce6686861548-8"><span class="crayon-e">mapply</span><span class="crayon-sy">(</span><span class="crayon-v">sabr</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">forward</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">tau</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">1</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">exp</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">tanh</span><span class="crayon-sy">(</span><span class="crayon-v">par_sabr</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line" id="crayon-5c27c4e0efce6686861548-9"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-e">cbind</span><span class="crayon-sy">(</span><span class="crayon-v">strike</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">.</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-o">&gt;&gt;</span><span class="crayon-o">%</span></div><div class="crayon-line crayon-striped-line" id="crayon-5c27c4e0efce6686861548-10"><span class="crayon-h">&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-e">lines</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">type</span><span class="crayon-o">=</span><span class="crayon-s">"l"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-o">=</span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-5c27c4e0efce6686861548-11"><span class="crayon-e">legend</span><span class="crayon-sy">(</span><span class="crayon-s">"topright"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">legend</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-s">"polynominal"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"SABR"</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">col</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">lty</span><span class="crayon-o">=</span><span class="crayon-e">c</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">bty</span><span class="crayon-o">=</span><span class="crayon-s">"n"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0042 seconds] -->
<p> </p>
<p><a href="http://nekopuni.holy.jp/wp-content/uploads/2014/11/141116_3.png" class="fancybox"><img src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/141116_3-287x300.png" alt="141116_3" width="287" height="300" class="alignleft size-medium wp-image-1330" srcset="http://nekopuni.holy.jp/wp-content/uploads/2014/11/141116_3-287x300.png 287w, http://nekopuni.holy.jp/wp-content/uploads/2014/11/141116_3.png 600w" sizes="(max-width: 287px) 100vw, 287px"></a></p>
<p>ということで、前述しましたように、polynoinal in deltaでは特に行使価格が非常に小さくなった領域におけるインプライド・ボラティリティを十分に与えられていないことが分かります。</p>
<h3>参考文献</h3>
<p>Foreign Exchange Option Pricing: A Practitioners Guide (The Wiley Finance Series)<br>
<a href="http://www.amazon.co.jp/dp/B005YX4VYE" target="_blank">http://www.amazon.co.jp/dp/B005YX4VYE</a></p>
<div style="min-height:33px;" class="really_simple_share really_simple_share_button robots-nocontent snap_nopreview"><div class="really_simple_share_twitter" style="width:100px;"><iframe id="twitter-widget-0" scrolling="no" frameborder="0" allowtransparency="true" class="twitter-share-button twitter-share-button-rendered twitter-tweet-button" style="position: static; visibility: visible; width: 61px; height: 20px;" title="Twitter Tweet Button" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/tweet_button.d30011b0f5ce05b98f24b01d3331b3c1.en-gb.html" data-url="http://nekopuni.holy.jp/2014/11/r%e7%82%ba%e6%9b%bf%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8b%e3%82%89%e3%83%9c%e3%83%a9%e3%83%86%e3%82%a3%e3%83%aa%e3%83%86%e3%82%a3%e3%83%bb%e3%82%b9/"></iframe></div><div class="really_simple_share_readygraph_infolinks" style="width:110px;"></div></div>
		<div class="really_simple_share_clearfix"></div>			</div><!-- .entry-content -->

		<footer class="entry-meta entry-footer entry-footer-meta">
						<span class="tags-links">
			<a href="http://nekopuni.holy.jp/tag/r/" rel="tag">R</a>		</span>
			</footer><!-- .entry-meta -->
	</article><!-- #post-## -->


				<nav class="navigation post-navigation" role="navigation">
		<h1 class="screen-reader-text">Post navigation</h1>
		<div class="nav-links">
			<div class="nav-previous"><div class="post-nav-title">Older post</div><a href="http://nekopuni.holy.jp/2014/10/rpython%e7%82%ba%e6%9b%bf%e7%a7%92%e8%b6%b3%e3%83%87%e3%83%bc%e3%82%bf%e3%81%b8%e3%81%aeone-pass-algorithm%e3%81%ae%e9%81%a9%e7%94%a8/" rel="prev">為替秒足データへのOne pass algorithmの適用</a></div><div class="nav-next"><div class="post-nav-title">Newer post</div><a href="http://nekopuni.holy.jp/2014/11/pythoncsv%e8%aa%ad%e3%81%bf%e8%be%bc%e3%81%bf%e5%82%99%e5%bf%98%e9%8c%b2/" rel="next">csv読み込み備忘録</a></div>		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
			
<div id="disqus_thread"><iframe id="dsq-app7419" name="dsq-app7419" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/saved_resource.html" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 539px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div>

		
		</main><!-- #main -->
	</div><!-- #primary -->


<div id="secondary" class="sidebar-area" role="complementary">
	<div class="widget-area">
		<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://nekopuni.holy.jp/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search …" value="" name="s">
				</label>
				<input type="submit" class="search-submit" value="Search">
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
											<li>
					<a href="http://nekopuni.holy.jp/2017/04/how-did-cash-perform-in-developed-countries-since-1694/">How did cash perform in developed countries since 1694</a>
									</li>
											<li>
					<a href="http://nekopuni.holy.jp/2017/03/greeks-under-normal-model/">Greeks under normal model</a>
									</li>
											<li>
					<a href="http://nekopuni.holy.jp/2017/02/thinking-fast-and-slow/">Thinking, Fast and Slow</a>
									</li>
											<li>
					<a href="http://nekopuni.holy.jp/2017/02/putwrite-versus-buywrite-yes-put-call-parity-holds-here-too/">PutWrite versus BuyWrite: Yes, Put-Call Parity Holds Here Too</a>
									</li>
											<li>
					<a href="http://nekopuni.holy.jp/2016/10/%e4%bb%bb%e6%84%8f%e3%81%ae%e5%85%b1%e5%88%86%e6%95%a3%e8%a1%8c%e5%88%97%e3%81%ab%e5%be%93%e3%81%86%e6%ad%a3%e8%a6%8f%e4%b9%b1%e6%95%b0%e3%81%ae%e7%94%9f%e6%88%90/">任意の共分散行列に従う正規乱数の生成</a>
									</li>
					</ul>
		</aside><aside id="tag_cloud-2" class="widget widget_tag_cloud"><h1 class="widget-title">Tags</h1><div class="tagcloud"><a href="http://nekopuni.holy.jp/tag/book-review/" class="tag-cloud-link tag-link-26 tag-link-position-1" style="font-size: 8pt;" aria-label="Book review (1 item)">Book review</a>
<a href="http://nekopuni.holy.jp/tag/cython/" class="tag-cloud-link tag-link-18 tag-link-position-2" style="font-size: 8pt;" aria-label="Cython (1 item)">Cython</a>
<a href="http://nekopuni.holy.jp/tag/excel/" class="tag-cloud-link tag-link-13 tag-link-position-3" style="font-size: 12.0287769784pt;" aria-label="Excel (4 items)">Excel</a>
<a href="http://nekopuni.holy.jp/tag/finance/" class="tag-cloud-link tag-link-19 tag-link-position-4" style="font-size: 13.5395683453pt;" aria-label="Finance (6 items)">Finance</a>
<a href="http://nekopuni.holy.jp/tag/google-finance/" class="tag-cloud-link tag-link-15 tag-link-position-5" style="font-size: 8pt;" aria-label="Google finance (1 item)">Google finance</a>
<a href="http://nekopuni.holy.jp/tag/investment/" class="tag-cloud-link tag-link-11 tag-link-position-6" style="font-size: 16.8633093525pt;" aria-label="Investment (14 items)">Investment</a>
<a href="http://nekopuni.holy.jp/tag/keras/" class="tag-cloud-link tag-link-23 tag-link-position-7" style="font-size: 8pt;" aria-label="Keras (1 item)">Keras</a>
<a href="http://nekopuni.holy.jp/tag/momentum/" class="tag-cloud-link tag-link-24 tag-link-position-8" style="font-size: 8pt;" aria-label="Momentum (1 item)">Momentum</a>
<a href="http://nekopuni.holy.jp/tag/mongodb/" class="tag-cloud-link tag-link-8 tag-link-position-9" style="font-size: 8pt;" aria-label="MongoDB (1 item)">MongoDB</a>
<a href="http://nekopuni.holy.jp/tag/mysql/" class="tag-cloud-link tag-link-21 tag-link-position-10" style="font-size: 9.81294964029pt;" aria-label="MySQL (2 items)">MySQL</a>
<a href="http://nekopuni.holy.jp/tag/nysol/" class="tag-cloud-link tag-link-16 tag-link-position-11" style="font-size: 9.81294964029pt;" aria-label="nysol (2 items)">nysol</a>
<a href="http://nekopuni.holy.jp/tag/paper-review/" class="tag-cloud-link tag-link-25 tag-link-position-12" style="font-size: 8pt;" aria-label="Paper review (1 item)">Paper review</a>
<a href="http://nekopuni.holy.jp/tag/python/" class="tag-cloud-link tag-link-9 tag-link-position-13" style="font-size: 20.3884892086pt;" aria-label="Python (33 items)">Python</a>
<a href="http://nekopuni.holy.jp/tag/quandl/" class="tag-cloud-link tag-link-10 tag-link-position-14" style="font-size: 14.0431654676pt;" aria-label="Quandl (7 items)">Quandl</a>
<a href="http://nekopuni.holy.jp/tag/r/" class="tag-cloud-link tag-link-12 tag-link-position-15" style="font-size: 22pt;" aria-label="R (48 items)">R</a>
<a href="http://nekopuni.holy.jp/tag/shiny/" class="tag-cloud-link tag-link-17 tag-link-position-16" style="font-size: 8pt;" aria-label="Shiny (1 item)">Shiny</a>
<a href="http://nekopuni.holy.jp/tag/vba/" class="tag-cloud-link tag-link-20 tag-link-position-17" style="font-size: 11.0215827338pt;" aria-label="VBA (3 items)">VBA</a></div>
</aside><aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
			<li><a href="http://nekopuni.holy.jp/2017/04/">April 2017</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2017/03/">March 2017</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2017/02/">February 2017</a>&nbsp;(2)</li>
	<li><a href="http://nekopuni.holy.jp/2016/10/">October 2016</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2016/09/">September 2016</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2016/08/">August 2016</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2016/07/">July 2016</a>&nbsp;(2)</li>
	<li><a href="http://nekopuni.holy.jp/2016/05/">May 2016</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2015/12/">December 2015</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2015/08/">August 2015</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2015/06/">June 2015</a>&nbsp;(2)</li>
	<li><a href="http://nekopuni.holy.jp/2015/05/">May 2015</a>&nbsp;(6)</li>
	<li><a href="http://nekopuni.holy.jp/2015/04/">April 2015</a>&nbsp;(4)</li>
	<li><a href="http://nekopuni.holy.jp/2015/03/">March 2015</a>&nbsp;(3)</li>
	<li><a href="http://nekopuni.holy.jp/2015/02/">February 2015</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2015/01/">January 2015</a>&nbsp;(4)</li>
	<li><a href="http://nekopuni.holy.jp/2014/12/">December 2014</a>&nbsp;(6)</li>
	<li><a href="http://nekopuni.holy.jp/2014/11/">November 2014</a>&nbsp;(2)</li>
	<li><a href="http://nekopuni.holy.jp/2014/10/">October 2014</a>&nbsp;(2)</li>
	<li><a href="http://nekopuni.holy.jp/2014/09/">September 2014</a>&nbsp;(5)</li>
	<li><a href="http://nekopuni.holy.jp/2014/08/">August 2014</a>&nbsp;(8)</li>
	<li><a href="http://nekopuni.holy.jp/2014/07/">July 2014</a>&nbsp;(3)</li>
	<li><a href="http://nekopuni.holy.jp/2014/06/">June 2014</a>&nbsp;(4)</li>
	<li><a href="http://nekopuni.holy.jp/2014/05/">May 2014</a>&nbsp;(4)</li>
	<li><a href="http://nekopuni.holy.jp/2014/04/">April 2014</a>&nbsp;(3)</li>
	<li><a href="http://nekopuni.holy.jp/2014/03/">March 2014</a>&nbsp;(5)</li>
	<li><a href="http://nekopuni.holy.jp/2014/02/">February 2014</a>&nbsp;(3)</li>
	<li><a href="http://nekopuni.holy.jp/2014/01/">January 2014</a>&nbsp;(4)</li>
	<li><a href="http://nekopuni.holy.jp/2013/12/">December 2013</a>&nbsp;(6)</li>
	<li><a href="http://nekopuni.holy.jp/2013/10/">October 2013</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2013/09/">September 2013</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2013/08/">August 2013</a>&nbsp;(2)</li>
	<li><a href="http://nekopuni.holy.jp/2013/02/">February 2013</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2013/01/">January 2013</a>&nbsp;(2)</li>
	<li><a href="http://nekopuni.holy.jp/2012/11/">November 2012</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2012/09/">September 2012</a>&nbsp;(2)</li>
	<li><a href="http://nekopuni.holy.jp/2012/08/">August 2012</a>&nbsp;(3)</li>
	<li><a href="http://nekopuni.holy.jp/2012/07/">July 2012</a>&nbsp;(1)</li>
	<li><a href="http://nekopuni.holy.jp/2012/06/">June 2012</a>&nbsp;(3)</li>
		</ul>
		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h1 class="widget-title">Recent Comments</h1><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">朱韬南</span> on <a href="http://nekopuni.holy.jp/2014/08/pythonreinforcement-learning-fx-trading-strategy/#comment-6327">Reinforcement Learning + FX Trading Strategy</a></li><li class="recentcomments"><span class="comment-author-link">Nekopuni</span> on <a href="http://nekopuni.holy.jp/2016/10/%e4%bb%bb%e6%84%8f%e3%81%ae%e5%85%b1%e5%88%86%e6%95%a3%e8%a1%8c%e5%88%97%e3%81%ab%e5%be%93%e3%81%86%e6%ad%a3%e8%a6%8f%e4%b9%b1%e6%95%b0%e3%81%ae%e7%94%9f%e6%88%90/#comment-6324">任意の共分散行列に従う正規乱数の生成</a></li><li class="recentcomments"><span class="comment-author-link">nw</span> on <a href="http://nekopuni.holy.jp/2016/10/%e4%bb%bb%e6%84%8f%e3%81%ae%e5%85%b1%e5%88%86%e6%95%a3%e8%a1%8c%e5%88%97%e3%81%ab%e5%be%93%e3%81%86%e6%ad%a3%e8%a6%8f%e4%b9%b1%e6%95%b0%e3%81%ae%e7%94%9f%e6%88%90/#comment-6323">任意の共分散行列に従う正規乱数の生成</a></li><li class="recentcomments"><span class="comment-author-link"><a href="http://webfun.tech/make-combination-by-expandgrid-and-subset-in-r/" rel="external nofollow" class="url">Rで重複のない組み合わせをexpand.grid()とsubset()で作る – webfun.tech beta</a></span> on <a href="http://nekopuni.holy.jp/2015/02/r%e3%83%a1%e3%83%a2-%e9%87%8d%e8%a4%87%e3%81%ae%e7%84%a1%e3%81%84%e3%83%8d%e3%82%b9%e3%83%88%e3%83%ab%e3%83%bc%e3%83%97%e3%82%92%e4%bd%9c%e3%82%8b/#comment-6322">メモ: 重複の無いネストループを作る</a></li><li class="recentcomments"><span class="comment-author-link">Nekopuni</span> on <a href="http://nekopuni.holy.jp/2016/10/%e4%bb%bb%e6%84%8f%e3%81%ae%e5%85%b1%e5%88%86%e6%95%a3%e8%a1%8c%e5%88%97%e3%81%ab%e5%be%93%e3%81%86%e6%ad%a3%e8%a6%8f%e4%b9%b1%e6%95%b0%e3%81%ae%e7%94%9f%e6%88%90/#comment-6321">任意の共分散行列に従う正規乱数の生成</a></li></ul></aside>	</div>
</div><!-- #secondary -->

	</div><!-- #content -->

	<footer id="colophon" class="site-footer" role="contentinfo">
						<div class="site-bottom">
						<div class="site-info">
												<div class="site-credit">
					Powered by <a href="http://wordpress.org/">WordPress</a>				<span class="sep"> | </span>
					Theme by <a href="http://themehaus.net/">Themehaus</a>				</div>
							</div>
		</div>
			</footer><!-- #colophon -->
</div><!-- #page -->

<script type="text/javascript">
        //<![CDATA[
        
      !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="https://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
      
        //]]>
  		</script><script type="text/javascript">
/* <![CDATA[ */
var countVars = {"disqusShortname":"momentum-1"};
/* ]]> */
</script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/comment_count.js"></script>
<script type="text/javascript">
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.15"},"disqusIdentifier":"1327 http:\/\/nekopuni.holy.jp\/?p=1327","disqusShortname":"momentum-1","disqusTitle":"\u70ba\u66ff\u30aa\u30d7\u30b7\u30e7\u30f3\u30c7\u30fc\u30bf\u304b\u3089\u30dc\u30e9\u30c6\u30a3\u30ea\u30c6\u30a3\u30fb\u30b9\u30de\u30a4\u30eb\u3092\u69cb\u7bc9","disqusUrl":"http:\/\/nekopuni.holy.jp\/2014\/11\/r%e7%82%ba%e6%9b%bf%e3%82%aa%e3%83%97%e3%82%b7%e3%83%a7%e3%83%b3%e3%83%87%e3%83%bc%e3%82%bf%e3%81%8b%e3%82%89%e3%83%9c%e3%83%a9%e3%83%86%e3%82%a3%e3%83%aa%e3%83%86%e3%82%a3%e3%83%bb%e3%82%b9\/","postId":"1327"};
/* ]]> */
</script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/comment_embed.js"></script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/navigation.js"></script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/skip-link-focus-fix.js"></script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/comment-reply.min.js"></script>
<script type="text/javascript" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/wp-embed.min.js"></script>




<!-- Dynamic page generated in 1.330 seconds. -->
<!-- Cached page generated by WP-Super-Cache on 2018-12-29 19:02:57 -->

<!-- super cache --><div id="cboxOverlay" style="display: none;"></div><div id="colorbox" class="" role="dialog" tabindex="-1" style="display: none;"><div id="cboxWrapper"><div><div id="cboxTopLeft" style="float: left;"></div><div id="cboxTopCenter" style="float: left;"></div><div id="cboxTopRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxMiddleLeft" style="float: left;"></div><div id="cboxContent" style="float: left;"><div id="cboxTitle" style="float: left;"></div><div id="cboxCurrent" style="float: left;"></div><button type="button" id="cboxPrevious"></button><button type="button" id="cboxNext"></button><button id="cboxSlideshow"></button><div id="cboxLoadingOverlay" style="float: left;"></div><div id="cboxLoadingGraphic" style="float: left;"></div></div><div id="cboxMiddleRight" style="float: left;"></div></div><div style="clear: left;"><div id="cboxBottomLeft" style="float: left;"></div><div id="cboxBottomCenter" style="float: left;"></div><div id="cboxBottomRight" style="float: left;"></div></div></div><div style="position: absolute; width: 9999px; visibility: hidden; display: none; max-width: none;"></div></div><iframe scrolling="no" frameborder="0" allowtransparency="true" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/widget_iframe.d30011b0f5ce05b98f24b01d3331b3c1.html" title="Twitter settings iframe" style="display: none;"></iframe><iframe style="display: none;" src="./為替オプションデータからボラティリティ・スマイルを構築 – Momentum_files/saved_resource(1).html"></iframe></body></html>